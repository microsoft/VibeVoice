#!/bin/bash
# ============================================================================
# Archivo: stack-vibe.conf
# Propósito: Configuración centralizada para el servicio de instalación VibeVoice
# Versión: 1.0.0
# Descripción: Única fuente de verdad para todos los parámetros de instalación
# ============================================================================

# ============================================================================
# INFORMACIÓN DEL SISTEMA
# ============================================================================
export VIBE_VERSION="1.0.0"
export VIBE_NOMBRE_PROYECTO="VibeVoice"
export VIBE_DESCRIPCION="Sistema de transcripción y análisis de voz con IA"

# ============================================================================
# CONFIGURACIÓN DE RUTAS
# ============================================================================
export VIBE_DIR_BASE="/opt/vibevoice"
export VIBE_DIR_DATOS="${VIBE_DIR_BASE}/datos"
export VIBE_DIR_LOGS="${VIBE_DIR_BASE}/logs"
export VIBE_DIR_CONFIG="${VIBE_DIR_BASE}/config"
export VIBE_DIR_BACKUPS="${VIBE_DIR_BASE}/backups"
export VIBE_DIR_TEMP="${VIBE_DIR_BASE}/temp"

# ============================================================================
# CONFIGURACIÓN DE PYTHON
# ============================================================================
export VIBE_PYTHON_VERSION="3.11"
export VIBE_PYTHON_MIN_VERSION="3.10"
export VIBE_VENV_DIR="${VIBE_DIR_BASE}/venv"
export VIBE_PYTHON_PACKAGES="torch torchaudio transformers fastapi uvicorn pydantic sqlalchemy redis kafka-python"

# ============================================================================
# CONFIGURACIÓN DE DOCKER
# ============================================================================
export VIBE_DOCKER_MIN_VERSION="24.0"
export VIBE_DOCKER_COMPOSE_MIN_VERSION="2.20"
export VIBE_DOCKER_NETWORK="vibevoice-network"
export VIBE_DOCKER_SUBNET="172.28.0.0/16"

# ============================================================================
# CONFIGURACIÓN DE POSTGRESQL
# ============================================================================
# ADVERTENCIA: Estas credenciales son solo para DESARROLLO/DEMO
# En producción, usar variables de entorno seguras o secret manager
export VIBE_POSTGRES_VERSION="15-alpine"
export VIBE_POSTGRES_HOST="localhost"
export VIBE_POSTGRES_PORT="5432"
export VIBE_POSTGRES_DB="vibevoice_db"
export VIBE_POSTGRES_USER="vibe_admin"
export VIBE_POSTGRES_PASSWORD="Cambiar_En_Produccion_123!"
export VIBE_POSTGRES_MAX_CONNECTIONS="200"
export VIBE_POSTGRES_SHARED_BUFFERS="256MB"

# ============================================================================
# CONFIGURACIÓN DE REDIS
# ============================================================================
export VIBE_REDIS_VERSION="7-alpine"
export VIBE_REDIS_HOST="localhost"
export VIBE_REDIS_PORT="6379"
export VIBE_REDIS_PASSWORD="Cambiar_En_Produccion_Redis456!"
export VIBE_REDIS_MAX_MEMORY="2gb"
export VIBE_REDIS_EVICTION_POLICY="allkeys-lru"

# ============================================================================
# CONFIGURACIÓN DE KAFKA
# ============================================================================
export VIBE_KAFKA_VERSION="3.5"
export VIBE_KAFKA_HOST="localhost"
export VIBE_KAFKA_PORT="9092"
export VIBE_KAFKA_ZOOKEEPER_PORT="2181"
export VIBE_KAFKA_HEAP_OPTS="-Xmx1G -Xms1G"
export VIBE_KAFKA_TOPICS="audio-input,transcription-output,analysis-results"

# ============================================================================
# CONFIGURACIÓN DE SERVICIOS VibeVoice
# ============================================================================
export VIBE_API_PORT="8000"
export VIBE_API_WORKERS="4"
export VIBE_API_TIMEOUT="300"
export VIBE_WEBSOCKET_PORT="8001"
export VIBE_ADMIN_PORT="8080"

# ============================================================================
# CONFIGURACIÓN DE SEGURIDAD
# ============================================================================
export VIBE_SECRET_KEY="CAMBIAR_ESTE_SECRET_KEY_EN_PRODUCCION_abc123xyz"
export VIBE_JWT_ALGORITHM="HS256"
export VIBE_JWT_EXPIRATION="3600"
export VIBE_CORS_ORIGINS="http://localhost:3000,http://localhost:8080"
export VIBE_ALLOWED_HOSTS="localhost,127.0.0.1"

# ============================================================================
# CONFIGURACIÓN DE RECURSOS DEL SISTEMA
# ============================================================================
export VIBE_MIN_RAM_GB="8"
export VIBE_MIN_DISK_GB="50"
export VIBE_MIN_CPU_CORES="4"

# ============================================================================
# CONFIGURACIÓN DE BITÁCORAS
# ============================================================================
export VIBE_LOG_LEVEL="INFO"
export VIBE_LOG_FORMAT="json"
export VIBE_LOG_RETENTION_DAYS="30"
export VIBE_LOG_MAX_SIZE="100M"
export VIBE_LOG_ROTATIONS="10"

# ============================================================================
# CONFIGURACIÓN DE RESPALDOS
# ============================================================================
export VIBE_BACKUP_ENABLED="true"
export VIBE_BACKUP_SCHEDULE="0 2 * * *"  # 2 AM diariamente
export VIBE_BACKUP_RETENTION_DAYS="7"
export VIBE_BACKUP_COMPRESSION="gzip"

# ============================================================================
# CONFIGURACIÓN DE SYSTEMD
# ============================================================================
export VIBE_SERVICE_NAME="vibevoice"
export VIBE_SERVICE_USER="vibevoice"
export VIBE_SERVICE_GROUP="vibevoice"
export VIBE_SERVICE_RESTART="always"
export VIBE_SERVICE_RESTART_SEC="10"

# ============================================================================
# CONFIGURACIÓN DE MONITOREO
# ============================================================================
export VIBE_HEALTH_CHECK_INTERVAL="30"
export VIBE_HEALTH_CHECK_TIMEOUT="10"
export VIBE_METRICS_ENABLED="true"
export VIBE_METRICS_PORT="9090"

# ============================================================================
# CONFIGURACIÓN DE UBUNTU
# ============================================================================
export VIBE_UBUNTU_VERSIONS="22.04 24.04"
export VIBE_REQUIRED_PACKAGES="curl wget git build-essential libssl-dev libffi-dev software-properties-common"

# ============================================================================
# FIN DE CONFIGURACIÓN
# ============================================================================
